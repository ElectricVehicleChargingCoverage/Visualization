{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "width": 800,
  "height": 700,
  "padding": {
    "top": 0,
    "left": 0,
    "right": 0,
    "bottom": 0
  },
  "autosize": "none",
  "signals": [
    {
      "name": "min_kw_selection",
      "label": "minimum rated power in kilowatt",
      "value": 150,
      "bind": {
        "input": "number",
        "min": 0,
        "max": 360,
        "step": 10
      }
    },
    {
      "name": "federal state",
      "bind": {
        "input": "select",
        "options": ["all", "Brandenburg", "North-Rhine-Westphalia", "..."]
      }
    },
    {
      "name": "symbol_size",
      "description": "point size",
      "value": 30,
      "bind": {
        "input": "number",
        "min": 10,
        "max": 200,
        "step": 10
      }
    }
  ],
  "data": [
    {
      "name": "germany",
      "url": "data/germany_plz.json",
      "format": {
        "type": "topojson",
        "feature": "segments"
      },
      "transform": [
        {
          "type": "geopath",
          "projection": "projection"
        }
      ]
    },
    {
      "name": "charging_stations",
      "url": "data/charger_locations_kw.csv",
      "format": {
        "type": "csv",
        "parse": "auto"
      },
      "transform": [
        {
          "type": "geopoint",
          "projection": "projection",
          "fields": [
            "lon",
            "lat"
          ]
        },
        {
          "type": "filter",
          "expr": "datum.ratedPowerKW >= min_kw_selection"
        }
      ]
    }
  ],
  "projections": [
    {
      "name": "projection",
      "type": "orthographic",
      "scale": 5000,
      "rotate": [
        -6,
        -52.5,
        0
      ],
      "center": [
        3,
        0
      ]
    }
  ],
  "marks": [
    {
      "type": "path",
      "from": {
        "data": "germany"
      },
      "encode": {
        "enter": {
          "fill": {
            "value": "#dedede"
          },
          "stroke": {
            "value": "#FFFFFF"
          }
        },
        "update": {
          "path": {
            "field": "path"
          }
        }
      }
    },
    {
      "type": "symbol",
      "from": {
        "data": "charging_stations"
      },
      "encode": {
        "enter": {
          "fillOpacity": {
            "value": 0.8
          },
          "size": {
            "value": 30
          },
          "fillOpacity": {
            "value": 0.7
          },
          "stroke": {
            "value": "white"
          },
          "strokeWidth": {
            "value": 1.5
          }
        },
        "update": {
          "size": {"signal": "symbol_size"},
          "fill": {
            "value": "steelblue"
          },
          "x": {
            "field": "x"
          },
          "y": {
            "field": "y"
          }
        },
        "hover": {
          "fill": {
            "value": "red"
          },
          "size": {
            "value": 80
          }
        }
      }
    }
  ]
}